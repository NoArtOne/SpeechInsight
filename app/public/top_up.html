<!DOCTYPE html>
<html>
<head>
    <title>Top Up Balance</title>
</head>
<body>
    <h1>Top Up Balance</h1>
      <form action="/users/top_up" method="post">
        <p>Click the button below to top up your balance.</p>
        <input type="submit" value="Top Up">
    </form>
    <p><a href="/user_profile">Back to Profile</a></p>
     <!-- Display updated balance (using JavaScript) -->
    <div id="balance-info">
        <!-- Balance will be loaded here -->
    </div>

    <script>

        // Function to fetch and display the user's balance
        function fetchAndDisplayBalance() {
            fetch('/users/me')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    const balanceInfoDiv = document.getElementById('balance-info');
                    balanceInfoDiv.innerHTML = `<p>Current Balance: ${data.balance}</p>`;
                })
                .catch(error => {
                    console.error('Error fetching user data:', error);
                    const balanceInfoDiv = document.getElementById('balance-info');
                    balanceInfoDiv.innerHTML = `<p>Error loading balance: ${error.message}</p>`;
                });
        }
          // Fetch and display balance when the page loads
        fetchAndDisplayBalance();
    </script>
</body>
</html>